{# =============================== #}
{# File: mindstack_app/modules/learning/flashcard_learning/templates/_flashcard_session_stats.html #}
{# Phiên bản: 1.3 #}
{# MỤC ĐÍCH: File partial chứa giao diện cho khung thống kê phiên học, bao gồm cả CSS. #}
{# ĐÃ SỬA: Đưa toàn bộ CSS liên quan vào trong file này để đảm bảo tính độc lập. #}
{# ĐÃ SỬA: Thêm CSS cho `.statistics-card` để khắc phục lỗi mất nền và cố định kích thước. #}
{# =============================== #}

<style>
    /* Styles cho Progress Bar */
    .statistics-card-new {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .progress-bar-group {
      margin-bottom: 1rem;
    }

    .progress-bar-label {
      font-size: 0.875rem;
      font-weight: 600;
      color: #374151;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.25rem;
    }

    .progress-bar-container {
      width: 100%;
      background-color: #e5e7eb;
      border-radius: 9999px;
      overflow: hidden;
      height: 1.25rem;
    }

    .progress-bar-fill {
      height: 100%;
      width: 0%;
      transition: width 0.5s ease-in-out;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.75rem;
      font-weight: 700;
      white-space: nowrap;
    }

    .progress-bar-fill-correct { background-color: #10b981; }
    .progress-bar-fill-vague { background-color: #f59e0b; }
    .progress-bar-fill-incorrect { background-color: #ef4444; }

    /* THÊM MỚI: CSS cho phần thông tin thẻ vừa học */
    .card-info-section {
        border-top: 1px solid #e5e7eb;
        padding-top: 1.5rem;
        margin-top: 1.5rem;
    }
    .card-info-title {
        display: flex;
        align-items: center;
        font-weight: 600;
        color: #3b82f6;
        cursor: pointer;
        user-select: none;
        margin-bottom: 0.5rem;
    }
    .card-info-title i {
        margin-right: 0.5rem;
        transition: transform 0.2s ease;
    }
    .card-info-title.collapsed i {
        transform: rotate(-90deg);
    }
    .card-info-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
    }
    .card-info-content.open {
        max-height: 500px; /* Giá trị lớn hơn nội dung để chuyển động mượt mà */
        padding-top: 0.5rem;
    }
    .card-info-content p {
        font-size: 0.875rem;
        line-height: 1.4;
        color: #4b5563;
        margin-bottom: 0.5rem;
        white-space: pre-wrap;
    }
    .card-info-content .label {
        font-weight: 600;
        color: #1f2937;
    }

    /* THÊM MỚI: CSS cho grid hiển thị chỉ số thống kê */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        margin-top: 1rem;
    }
    .stat-box {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        padding: 1rem;
        border: 1px solid #e5e7eb;
        border-radius: 0.5rem;
        background-color: #f9fafb;
    }
    .stat-box .icon {
        font-size: 1.5rem;
        color: #3b82f6;
        margin-bottom: 0.5rem;
    }
    .stat-box .value {
        font-size: 1.125rem;
        font-weight: 700;
        color: #1f2937;
    }
    .stat-box .label {
        font-size: 0.875rem;
        color: #6b7280;
    }
    .stat-box.status .value {
        text-transform: capitalize;
    }
    
    /* Styles cho khung thống kê chính */
    .statistics-card {
        background: #fff;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, .08);
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        height: 100%;
        min-height: 0;
        overflow-y: auto;
        width: 500px;
    }

</style>

<div class="statistics-card">
    <h3 class="text-lg font-semibold text-center text-gray-800 mb-4">Thống kê phiên học</h3>
    
    <div class="bg-gray-50 p-4 rounded-lg mb-6">
        <div class="grid grid-cols-2 gap-4 text-center">
            <div>
                <span class="text-sm font-medium text-gray-500">Tổng điểm</span>
                <div id="total-score-display" class="text-2xl font-bold text-gray-800 flex items-center justify-center">
                    <i class="fas fa-star text-yellow-400 mr-2"></i>
                    <span>-</span>
                </div>
            </div>
            <div>
                <span class="text-sm font-medium text-gray-500">Điểm phiên này</span>
                <div id="session-score-display" class="text-2xl font-bold text-green-600">
                    +0
                </div>
            </div>
        </div>
    </div>
    
    <hr class="my-6">
    <h3 class="text-lg font-semibold text-center text-gray-800 mb-4">Thống kê thẻ trước đó</h3>
    <div id="current-card-stats" class="flex-grow space-y-4">
        <div class="text-center text-gray-500">
            <i class="fas fa-info-circle mr-2"></i> Trả lời thẻ để xem thống kê.
        </div>
    </div>

    <hr class="my-6">
    <div class="mt-2 flex justify-center">
        <button id="end-session-btn" class="px-6 py-3 bg-gray-300 text-gray-800 rounded-lg font-semibold hover:bg-gray-400 shadow-sm">Kết thúc phiên</button>
    </div>
</div>