{# Desktop Interface Partial (Batch-Like Style) #}

<div class="hidden lg:block cm-shell quiz-shell">
    <div class="cm-container mx-auto px-4 max-w-7xl">

        {# === HEADER GROUP === #}
        <div class="quiz-section-header">
            <div class="cm-heading-group quiz-heading-group">
                <span class="text-sm font-bold text-blue-600 uppercase tracking-wider mb-1 block">Phiên học cá
                    nhân</span>
                <h1 class="text-3xl font-bold text-slate-900 mb-2">Làm bài Quiz</h1>
                <p class="text-slate-500 max-w-2xl">Chọn đáp án chính xác nhất. Kết quả và giải thích chi tiết sẽ hiện
                    ra sau khi bạn trả lời.</p>
                <div class="mt-4">
                    <a href="/" class="text-slate-500 hover:text-blue-600 text-sm font-medium mr-4"><i
                            class="fa-solid fa-arrow-left"></i> Trang chủ</a>
                    <button id="desktop-exit-btn" class="text-red-500 hover:text-red-700 text-sm font-medium"><i
                            class="fa-solid fa-right-from-bracket"></i> Kết thúc phiên</button>
                </div>
            </div>

            {# === STATS CARD === #}
            <div class="quiz-progress-card">
                <div class="progress-card-header">
                    <div class="progress-card-title">
                        <span class="progress-card-icon"><i class="fas fa-chart-pie"></i></span>
                        <div class="flex flex-col">
                            <span class="progress-card-heading">Thống kê phiên</span>
                        </div>
                    </div>
                </div>

                <div class="progress-card-stats-grid">
                    <div class="progress-stat-item">
                        <span class="progress-stat-value js-stat-total">0</span>
                        <span class="progress-stat-label">Đã làm</span>
                    </div>
                    <div class="progress-stat-item">
                        <span class="progress-stat-value text-emerald-600 js-stat-correct">0</span>
                        <span class="progress-stat-label">Đúng</span>
                    </div>
                    <div class="progress-stat-item">
                        <span class="progress-stat-value text-blue-600 js-stat-accuracy">0%</span>
                        <span class="progress-stat-label">Chính xác</span>
                    </div>
                </div>

                <div class="text-xs text-slate-400 font-semibold uppercase tracking-wider mb-1 flex justify-between">
                    <span>Tiến độ</span>
                    <span class="js-stat-progress-text">0/0</span>
                </div>
                <div class="progress-bar-track">
                    <div class="progress-bar-fill js-stat-progress-bar" style="width: 0%"></div>
                </div>
            </div>
        </div>

        {# === MAIN QUIZ CARD === #}
        <div class="cm-card cm-card--padded quiz-card">

            <div class="relative min-h-[400px]">
                <!-- Loading State -->
                <div class="absolute inset-0 flex flex-col items-center justify-center text-blue-500 js-quiz-loading">
                    <i class="fas fa-spinner fa-spin text-4xl mb-3"></i>
                    <p>Đang tải câu hỏi...</p>
                </div>

                <!-- Question Content -->
                <div class="hidden js-quiz-content question-card">
                    <div class="question-meta">
                        <span class="js-question-header">Câu hỏi --</span>
                    </div>

                    <h2 class="question-title js-question-text">--</h2>

                    <div class="mb-6 hidden js-question-media">
                        <!-- Media injected here -->
                    </div>

                    <div class="qb-options-grid js-options-grid">
                        <!-- Options injected here -->
                    </div>

                    <!-- Feedback Area (Desktop Inline) -->
                    <div class="hidden js-result-panel desktop-feedback-box">
                        <div class="text-2xl js-feedback-icon"></div>
                        <div class="flex-1">
                            <h4 class="font-bold text-lg mb-1 js-feedback-title">Title</h4>
                            <p class="text-sm">Đáp án đúng: <span class="font-bold js-feedback-answer">--</span></p>

                            <!-- Detailed Explanation Block -->
                            <div id="desktop-explanation" class="hidden mt-4 pt-4 border-t border-black/10">
                                <h5 class="font-bold text-sm uppercase text-slate-500 mb-2">Giải thích chi tiết</h5>
                                <div id="desktop-explanation-content"
                                    class="markdown-body text-sm text-slate-800 leading-relaxed"></div>
                            </div>
                        </div>
                    </div>

                    <!-- BATCH-STYLE POST-ANSWER INSIGHTS (Hidden until answered) -->
                    <div id="desktop-insights-area" class="question-insights hidden">

                        <!-- Extra Info: Notes & AI -->
                        <div class="extra-info-area">
                            <!-- User Notes -->
                            <div class="info-section user-note-section">
                                <h4>
                                    <span><i class="fas fa-sticky-note text-yellow-500"></i> Ghi chú của bạn</span>
                                    <button id="desktop-note-edit-btn"
                                        class="hidden text-xs bg-blue-100 text-blue-600 border border-blue-200 px-3 py-1.5 rounded hover:bg-blue-200 font-medium">
                                        <i class="fa-solid fa-pencil"></i> Sửa ghi chú
                                    </button>
                                </h4>

                                <!-- Display Mode -->
                                <div id="desktop-note-display-mode" class="hidden">
                                    <div id="desktop-note-content"
                                        class="content-display min-h-[50px] text-slate-700 whitespace-pre-wrap"></div>
                                </div>

                                <!-- Edit Mode -->
                                <div id="desktop-note-edit-mode" class="hidden">
                                    <textarea id="desktop-note-input" class="note-textarea"
                                        placeholder="Ghi chú cho câu này..."></textarea>
                                    <div class="flex justify-end mt-2 gap-2">
                                        <button id="desktop-note-cancel"
                                            class="cm-btn bg-white hover:bg-slate-100 text-slate-600 border border-slate-300 py-1.5 px-4 text-sm rounded-md">Hủy</button>
                                        <button id="desktop-note-save"
                                            class="cm-btn bg-emerald-600 text-white hover:bg-emerald-700 py-1.5 px-4 text-sm rounded-md">Lưu
                                            ghi chú</button>
                                    </div>
                                </div>
                            </div>

                            <!-- AI Explanation -->
                            <div class="info-section ai-explanation-section">
                                <h4>
                                    <span><i class="fas fa-robot text-blue-500"></i> Giải thích AI</span>
                                    <button id="desktop-ai-generate-btn"
                                        class="text-xs bg-blue-50 text-blue-600 border border-blue-200 px-2 py-1 rounded hover:bg-blue-100">
                                        <i class="fa-solid fa-wand-magic-sparkles"></i> Tạo mới
                                    </button>
                                </h4>
                                <div id="desktop-ai-content"
                                    class="content-display markdown-body min-h-[50px] text-slate-500 italic">
                                    Chưa có giải thích từ AI. Nhấn nút "Tạo mới" để yêu cầu.
                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- End Insights -->

                    <!-- Action Bar -->
                    <div class="desktop-action-bar">
                        <button type="button" id="desktop-action-btn" class="cm-btn cm-btn-primary px-8" disabled>
                            <i class="fa-solid fa-paper-plane"></i> Gửi đáp án
                        </button>
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>