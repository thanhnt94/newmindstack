{# ================= STATS MOBILE INTERFACE (LG:HIDDEN) ================= #}
<div class="lg:hidden bg-slate-50 min-h-screen pb-24">
    
    {# 1. Sticky Header #}
    <div class="sticky top-0 z-30 bg-white/90 backdrop-blur-md border-b border-slate-200 px-5 py-3 flex items-center justify-between">
        <div>
            <p class="text-[10px] text-slate-500 uppercase font-bold tracking-wider">Thống kê</p>
            <h1 class="text-lg font-extrabold text-slate-800">Tổng quan học tập</h1>
        </div>
    </div>

    {# 2. Key Metrics (Horizontal Scroll) #}
    <div class="px-5 pt-4 pb-2">
        <div class="flex overflow-x-auto gap-3 no-scrollbar snap-x scroll-pl-5 pb-2">
            {# Card 1: Tổng điểm #}
            <div class="snap-start flex-shrink-0 w-36 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-2xl p-3 shadow-md flex flex-col justify-between h-28 relative overflow-hidden">
                <div class="absolute right-0 top-0 p-2 opacity-20"><i class="fas fa-star text-5xl"></i></div>
                <span class="text-[10px] uppercase font-bold tracking-wide opacity-80">Tổng điểm</span>
                <div>
                    <p class="text-2xl font-bold leading-none">{{ "{:,}".format(dashboard_data.total_score_all_time) }}</p>
                    <p class="text-[9px] opacity-80 mt-1">All time</p>
                </div>
            </div>
            {# Card 2: Streak #}
            <div class="snap-start flex-shrink-0 w-36 bg-gradient-to-br from-orange-400 to-orange-500 text-white rounded-2xl p-3 shadow-md flex flex-col justify-between h-28 relative overflow-hidden">
                <div class="absolute right-0 top-0 p-2 opacity-20"><i class="fas fa-fire text-5xl"></i></div>
                <span class="text-[10px] uppercase font-bold tracking-wide opacity-80">Chuỗi</span>
                <div>
                    <p class="text-2xl font-bold leading-none">{{ dashboard_data.current_learning_streak }} ngày</p>
                    <p class="text-[9px] opacity-80 mt-1">Kỷ lục: {{ dashboard_data.longest_learning_streak }}</p>
                </div>
            </div>
            {# Card 3: 30 Ngày #}
            <div class="snap-start flex-shrink-0 w-36 bg-gradient-to-br from-emerald-400 to-emerald-500 text-white rounded-2xl p-3 shadow-md flex flex-col justify-between h-28 relative overflow-hidden">
                <div class="absolute right-0 top-0 p-2 opacity-20"><i class="fas fa-chart-line text-5xl"></i></div>
                <span class="text-[10px] uppercase font-bold tracking-wide opacity-80">30 Ngày qua</span>
                <div>
                    <p class="text-2xl font-bold leading-none">{{ "{:,}".format(dashboard_data.total_score_last_30_days) }}</p>
                    <p class="text-[9px] opacity-80 mt-1">~{{ "{:,.1f}".format(dashboard_data.average_daily_score_recent) }}/ngày</p>
                </div>
            </div>
        </div>
    </div>

    {# 3. Quick Stats Grid (Simple) #}
    <div class="px-5 mt-2">
        <h3 class="text-sm font-bold text-slate-800 mb-3 flex items-center"><i class="fas fa-layer-group text-indigo-500 mr-2"></i> Chi tiết bộ môn</h3>
        <div class="grid grid-cols-1 gap-3">
            <!-- Flashcard -->
            <div class="bg-white border border-slate-100 p-4 rounded-2xl shadow-sm flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-indigo-50 rounded-full flex items-center justify-center text-indigo-600">
                        <i class="fas fa-clone"></i>
                    </div>
                    <div>
                        <p class="text-sm font-bold text-slate-700">Flashcard</p>
                        <p class="text-[10px] text-slate-400">Đã thuộc: {{ dashboard_data.flashcard_mastered_count }} thẻ</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm font-bold text-indigo-600">{{ dashboard_data.flashcard_accuracy_percent }}%</p>
                    <p class="text-[9px] text-slate-400">Chính xác</p>
                </div>
            </div>
            <!-- Quiz -->
            <div class="bg-white border border-slate-100 p-4 rounded-2xl shadow-sm flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-emerald-50 rounded-full flex items-center justify-center text-emerald-600">
                        <i class="fas fa-question-circle"></i>
                    </div>
                    <div>
                        <p class="text-sm font-bold text-slate-700">Trắc nghiệm</p>
                        <p class="text-[10px] text-slate-400">Đã làm: {{ dashboard_data.quiz_sets_started_count }} bộ</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm font-bold text-emerald-600">{{ dashboard_data.quiz_accuracy_percent }}%</p>
                    <p class="text-[9px] text-slate-400">Chính xác</p>
                </div>
            </div>
            <!-- Course -->
            <div class="bg-white border border-slate-100 p-4 rounded-2xl shadow-sm flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-amber-50 rounded-full flex items-center justify-center text-amber-600">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div>
                        <p class="text-sm font-bold text-slate-700">Khóa học</p>
                        <p class="text-[10px] text-slate-400">Đang học: {{ dashboard_data.courses_in_progress_count }} khóa</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-sm font-bold text-amber-600">{{ dashboard_data.course_avg_completion_percent }}%</p>
                    <p class="text-[9px] text-slate-400">Hoàn thành</p>
                </div>
            </div>
        </div>
    </div>

    {# 4. Leaderboard (Simplified for Mobile) #}
    <div class="px-5 mt-6">
        <div class="flex items-center justify-between mb-3">
            <h3 class="text-sm font-bold text-slate-800 flex items-center"><i class="fas fa-trophy text-yellow-500 mr-2"></i> Bảng xếp hạng</h3>
            <span class="text-[10px] bg-slate-100 text-slate-500 px-2 py-1 rounded-md">Tuần này</span>
        </div>
        
        <div class="bg-white border border-slate-100 rounded-2xl shadow-sm overflow-hidden">
            <ul class="divide-y divide-slate-50">
                {% for entry in leaderboard_data[:5] %} {# Chỉ hiện Top 5 trên mobile #}
                <li class="flex items-center p-3 {% if entry.is_current_user %}bg-indigo-50/50{% endif %}">
                    <span class="w-6 text-center font-bold text-slate-400 text-sm mr-3">
                        {% if entry.rank == 1 %}<i class="fas fa-medal text-yellow-400"></i>
                        {% elif entry.rank == 2 %}<i class="fas fa-medal text-slate-400"></i>
                        {% elif entry.rank == 3 %}<i class="fas fa-medal text-amber-600"></i>
                        {% else %}{{ entry.rank }}{% endif %}
                    </span>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-bold text-slate-700 truncate">{{ entry.username }}</p>
                    </div>
                    <span class="text-xs font-bold text-indigo-600 ml-2">{{ "{:,}".format(entry.current_period_score) }}</span>
                </li>
                {% else %}
                <li class="p-4 text-center text-xs text-slate-400">Chưa có dữ liệu xếp hạng tuần này.</li>
                {% endfor %}
            </ul>
            <div class="p-2 text-center border-t border-slate-50">
                <button class="text-xs font-bold text-indigo-500 w-full py-1">Xem đầy đủ</button>
            </div>
        </div>
    </div>

    {# 5. Recent Activity Log #}
    <div class="px-5 mt-6 pb-8">
        <h3 class="text-sm font-bold text-slate-800 mb-3">Hoạt động gần đây</h3>
        <div class="space-y-3">
            {% for entry in recent_activity[:5] %}
            <div class="flex items-start gap-3 bg-white p-3 rounded-xl border border-slate-100 shadow-sm">
                <div class="w-2 h-2 mt-1.5 rounded-full {% if entry.score_change > 0 %}bg-green-500{% else %}bg-slate-300{% endif %}"></div>
                <div class="flex-1">
                    <p class="text-xs font-bold text-slate-700">{{ entry.reason }}</p>
                    <p class="text-[10px] text-slate-400 mt-0.5">{{ entry.timestamp }}</p>
                </div>
                <span class="text-xs font-bold {% if entry.score_change > 0 %}text-green-600{% else %}text-slate-400{% endif %}">
                    {{ '+' if entry.score_change > 0 }}{{ entry.score_change }}
                </span>
            </div>
            {% else %}
            <p class="text-center text-xs text-slate-400 py-4">Chưa có hoạt động nào.</p>
            {% endfor %}
        </div>
    </div>
</div>