{#
File: mindstack_app/templates/lumina/pages/dashboard/_mobile.html
Purpose: Mobile dashboard - Polished iOS App-like interface
#}
{% set _v = template_version or 'lumina' %}

{# === MOBILE APP INTERFACE === #}
<div class="lumina-mobile-app">

    {# === STICKY HEADER === #}
    <div class="lumina-mobile-header">
        <div class="lumina-mobile-header__top">
            <div class="lumina-mobile-header__avatar">
                {% if current_user.is_authenticated and current_user.avatar_url %}
                <img src="{{ current_user.get_avatar_url() }}" alt="Avatar">
                {% else %}
                <span>{{ current_user.username[0] | upper if current_user.is_authenticated else 'G' }}</span>
                {% endif %}
            </div>
            <div class="lumina-mobile-header__controls">
                <div class="lumina-mobile-stat-badge">
                    <i class="fa-solid fa-gem text-blue-500"></i>
                    <span>{{ "{:,}".format(current_user.total_score if current_user.is_authenticated and
                        current_user.total_score else 0) }}</span>
                </div>
                <button class="lumina-mobile-icon-btn" onclick="toggleNotificationCenter()">
                    <i class="fa-regular fa-bell"></i>
                </button>
            </div>
        </div>
        <div class="lumina-mobile-header__greeting">
            <h1 class="text-3xl font-bold tracking-tight text-gray-900">
                Xin chào, <br>
                <span class="text-indigo-600">{{ current_user.username if current_user.is_authenticated else 'Bạn'
                    }}</span>
            </h1>
        </div>
    </div>

    {# === SCROLLABLE CONTENT === #}
    <div class="lumina-mobile-content">

        {# === HERO: TODAY'S FOCUS === #}
        <div class="lumina-mobile-section">
            <div class="lumina-hero-banner">
                <div class="lumina-hero-banner__content">
                    <span class="lumina-tag">Tiêu điểm</span>
                    <h3 class="text-lg font-bold text-white mt-1 leading-snug">
                        Duy trì chuỗi học tập để đạt kết quả tốt nhất!
                    </h3>
                </div>
                <div class="lumina-hero-banner__icon">
                    <i class="fa-solid fa-fire-flame-curved"></i>
                </div>
            </div>
        </div>

        {# === QUICK ACTIONS (Horizontal) === #}
        <div class="lumina-mobile-section">
            <h3 class="lumina-section-title">Học tập</h3>
            <div class="lumina-h-scroll">
                <a href="{{ url_for('learning.vocabulary.dashboard') }}" class="lumina-app-card">
                    <div class="lumina-app-card__icon bg-blue-100 text-blue-600">
                        <i class="fa-solid fa-book-open"></i>
                    </div>
                    <span class="lumina-app-card__label">Từ vựng</span>
                </a>

                <a href="{{ url_for('learning.quiz_learning.dashboard') }}" class="lumina-app-card">
                    <div class="lumina-app-card__icon bg-green-100 text-green-600">
                        <i class="fa-solid fa-circle-question"></i>
                    </div>
                    <span class="lumina-app-card__label">Quiz</span>
                </a>

                <a href="{{ url_for('learning.practice.practice_hub') }}" class="lumina-app-card">
                    <div class="lumina-app-card__icon bg-orange-100 text-orange-600">
                        <i class="fa-solid fa-dumbbell"></i>
                    </div>
                    <span class="lumina-app-card__label">Luyện tập</span>
                </a>

                <a href="{{ url_for('learning.course.course_learning_dashboard') }}" class="lumina-app-card">
                    <div class="lumina-app-card__icon bg-purple-100 text-purple-600">
                        <i class="fa-solid fa-graduation-cap"></i>
                    </div>
                    <span class="lumina-app-card__label">Khóa học</span>
                </a>
            </div>
        </div>

        {# === STATS OFFSET === #}
        <div class="lumina-mobile-section">
            <h3 class="lumina-section-title">Thống kê</h3>
            <div class="grid grid-cols-2 gap-3">
                <div class="lumina-stat-box">
                    <span class="text-3xl font-black text-gray-900">0</span>
                    <span class="text-xs font-semibold text-gray-500 uppercase">Từ đã học</span>
                </div>
                <div class="lumina-stat-box">
                    <span class="text-3xl font-black text-gray-900">0</span>
                    <span class="text-xs font-semibold text-gray-500 uppercase">Ngày Streak</span>
                </div>
            </div>
        </div>

        {# === ACTIVE SESSIONS === #}
        <div class="lumina-mobile-section" id="lumina-active-sessions" style="display: none;">
            <h3 class="lumina-section-title">Đang học dở</h3>
            <div id="lumina-active-list" class="flex flex-col gap-3"></div>
        </div>

        {# === EXPLORE LIST === #}
        <div class="lumina-mobile-section">
            <h3 class="lumina-section-title">Khám phá</h3>
            <div class="lumina-list-group">
                <a href="{{ url_for('stats.dashboard') }}" class="lumina-list-item">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-cyan-100 text-cyan-600 flex items-center justify-center">
                            <i class="fa-solid fa-chart-line text-sm"></i>
                        </div>
                        <span class="font-medium text-gray-900">Thống kê chi tiết</span>
                    </div>
                    <i class="fa-solid fa-chevron-right text-gray-400 text-xs"></i>
                </a>
                <div class="lumina-divider"></div>
                <a href="{{ url_for('goals.manage_goals') }}" class="lumina-list-item">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-yellow-100 text-yellow-600 flex items-center justify-center">
                            <i class="fa-solid fa-bullseye text-sm"></i>
                        </div>
                        <span class="font-medium text-gray-900">Mục tiêu học tập</span>
                    </div>
                    <i class="fa-solid fa-chevron-right text-gray-400 text-xs"></i>
                </a>
                <div class="lumina-divider"></div>
                <a href="{{ url_for('content_management.content_dashboard') }}" class="lumina-list-item">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-violet-100 text-violet-600 flex items-center justify-center">
                            <i class="fa-solid fa-folder-open text-sm"></i>
                        </div>
                        <span class="font-medium text-gray-900">Kho nội dung</span>
                    </div>
                    <i class="fa-solid fa-chevron-right text-gray-400 text-xs"></i>
                </a>
            </div>
        </div>

        {# Bottom Spacer #}
        <div class="h-28"></div>
    </div>
</div>

<style>
    /* === UTILS === */
    .lumina-mobile-app {
        /* Handled by layout.css */
        background: #F2F2F7;
        /* iOS System Gray 6 */
    }

    /* === HEADER === */
    .lumina-mobile-header {
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        position: sticky;
        top: 0;
        z-index: 40;
        padding-bottom: 12px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }

    .lumina-mobile-header__top {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 20px 0;
    }

    .lumina-mobile-header__avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: #007AFF;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        overflow: hidden;
    }

    .lumina-mobile-header__avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .lumina-mobile-header__controls {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .lumina-mobile-stat-badge {
        background: rgba(0, 0, 0, 0.05);
        padding: 6px 12px;
        border-radius: 99px;
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 13px;
        font-weight: 600;
        color: #1C1C1E;
    }

    .lumina-mobile-icon-btn {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        color: #007AFF;
    }

    .lumina-mobile-header__greeting {
        padding: 12px 20px 0;
    }

    /* === CONTENT === */
    .lumina-mobile-content {
        padding: 20px;
    }

    .lumina-mobile-section {
        margin-bottom: 32px;
    }

    .lumina-section-title {
        font-size: 20px;
        font-weight: 700;
        color: #1C1C1E;
        margin-bottom: 16px;
        letter-spacing: -0.5px;
    }

    /* === COMPONENTS === */
    .lumina-hero-banner {
        background: linear-gradient(135deg, #5856D6, #AF52DE);
        border-radius: 20px;
        padding: 20px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 10px 20px rgba(88, 86, 214, 0.25);
    }

    .lumina-hero-banner__content {
        position: relative;
        z-index: 2;
    }

    .lumina-tag {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        font-size: 11px;
        font-weight: 700;
        text-transform: uppercase;
        padding: 4px 10px;
        border-radius: 8px;
    }

    .lumina-hero-banner__icon {
        position: absolute;
        bottom: -10px;
        right: -10px;
        font-size: 80px;
        color: white;
        opacity: 0.15;
        transform: rotate(-15deg);
    }

    /* H-Scroll */
    .lumina-h-scroll {
        display: flex;
        gap: 16px;
        overflow-x: auto;
        margin: 0 -20px;
        padding: 4px 20px 20px;
        scroll-snap-type: x mandatory;
    }

    .lumina-h-scroll::-webkit-scrollbar {
        display: none;
    }

    .lumina-app-card {
        flex: 0 0 auto;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        scroll-snap-align: start;
        text-align: center;
        width: 80px;
    }

    .lumina-app-card__icon {
        width: 64px;
        height: 64px;
        border-radius: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 28px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }

    .lumina-app-card__label {
        font-size: 12px;
        font-weight: 500;
        color: #1C1C1E;
    }

    /* Stats */
    .lumina-stat-box {
        background: white;
        padding: 20px;
        border-radius: 16px;
        text-align: center;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    /* List Group (iOS Settings Style) */
    .lumina-list-group {
        background: white;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    .lumina-list-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px;
        background: white;
    }

    .lumina-list-item:active {
        background: #F2F2F7;
    }

    .lumina-divider {
        height: 1px;
        background: #E5E5EA;
        margin-left: 60px;
        /* Indent divider */
    }
</style>